<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca ETEC Darcy - Empréstimo de Livros</title>
    <link rel="icon" href="assets/imagens/aura.png" type="image/png">
    <style>
/* Estilos básicos para ver a estrutura - serão refinados no CSS */
body {
    font-family: sans-serif;
    margin: 0;
    background-color: #E0D8B0; /* Bege Mais Profundo */
    color: #333;
}
header {
    background-color: #C8D8BF; /* Verde Sálvia */
    color: #333;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
header h1 {
    margin: 0;
    font-size: 1.8em;
}
.btn-login {
    background-color: #8B4513; /* Marrom Avelã */
    color: white;
    padding: 8px 15px;
    margin-right: 6vh;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
.search-filter-section {
    background-color: #A0B99F; /* Verde Oliva Suave/Musgo */
    padding: 20px;
    text-align: center;
    border-radius: 0 0 10px 10px;
}
.search-filter-section input[type="text"] {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    width: 70%;
    max-width: 400px;
    margin-right: 10px;
}
.filter-buttons button {
    background-color: #8B4513;
    color: white;
    padding: 8px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin: 5px;
}
.book-list-container {
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}
.book-card {
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.book-card img {
    max-width: 100px;
    height: auto;
    margin-bottom: 10px;
}
.book-card h3 {
    margin-top: 0;
    color: #C8D8BF; /* Verde Sálvia */
}
.book-card p {
    font-size: 0.9em;
    color: #555;
}
.book-status {
    font-weight: bold;
    color: green; /* Será dinâmico via JS */
    margin-bottom: 10px;
}
.btn-emprestar {
    background-color: #A0B99F; /* Verde Oliva Suave/Musgo */
    color: #8B4513; /* Marrom Avelã */
    padding: 8px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
}
footer {
    background-color: #A0B99F; /* Marrom Avelã */
    color: white;
    text-align: center;
    padding: 20px;
    margin-top: 30px;
}

/* Modal de Empréstimo */
.modal {
    display: none; /* Escondido por padrão */
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    justify-content: center;
    align-items: center;
}
.modal.show {
    display: flex; /* Exibido quando a classe 'show' é adicionada */
}
.modal-content {
    background-color: #FCFBF7; /* Off-white suave - NOVO */
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 500px;
    border-radius: 10px;
    text-align: center;
    position: relative;
}
.close-button {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    position: absolute;
    top: 10px;
    right: 20px;
    cursor: pointer;
}
.close-button:hover,
.close-button:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}
.modal-content input[type="text"] {
    width: calc(100% - 20px);
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
}
.modal-content button {
    background-color: #A0B99F;
    color: #8B4513;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
}
/* Estilo para os botões de filtro */
.filter-buttons button {
    background-color: #f0f0f0; /* Cor de fundo padrão */
    color: #333; /* Cor do texto padrão */
    border: 1px solid #ccc;
    padding: 8px 15px;
    margin: 5px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    font-size: 0.9em;
}

.filter-buttons button:hover {
    background-color: #e0e0e0; /* Um pouco mais escuro ao passar o mouse */
}

/* NOVO: Estilo para o botão de filtro ATIVO */
.filter-buttons button.active {
    background-color: #007bff; /* Cor principal, um azul vibrante */
    color: white; /* Texto branco para contraste */
    border-color: #007bff;
    font-weight: bold; /* Opcional: deixar o texto em negrito */
    box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3); /* Sombra sutil para destaque */
}
    </style>
</head>
<body>
    <header>
        <h1>Biblioteca ETEC Darcy</h1>
        <button class="btn-login" id="adminLoginBtn">Login Bibliotecária</button>
    </header>

    <main>
        <section class="search-filter-section">
            <input type="text" id="searchInput" placeholder="Pesquisar por título, autor, etc.">
            <div class="filter-buttons">
    <button data-filter="all">Todos</button>
    <button data-filter="available">Disponíveis</button>
    <button data-filter="Ficção">Ficção</button>
    <button data-filter="Fantasia">Fantasia</button>
    <button data-filter="Ficção Científica">Ficção Científica</button>
    <button data-filter="Mistério">Mistério</button>
    <button data-filter="Romance">Romance</button>
    <button data-filter="Biografia">Biografia</button>
    <button data-filter="História">História</button>
    <button data-filter="Outros">Outros</button>
</div>
        </section>

        <section class="book-list-container" id="bookList">
            </section>

        <div id="loanModal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h2>Solicitar Empréstimo</h2>
                <p>Você está solicitando o livro: <strong id="modalBookTitle"></strong></p>
                <input type="text" id="studentName" placeholder="Seu Nome Completo" required>
                <input type="text" id="studentClass" placeholder="Sua Turma (Ex: 1º ETIM Informática)" required>
                <button id="confirmLoanBtn">Confirmar Empréstimo</button>
                <p id="loanCodeDisplay" style="margin-top: 15px; font-weight: bold; color: green; display: none;"></p>
                <p style="font-size: 0.8em; margin-top: 10px;">Lembre-se: o prazo de devolução é de 30 dias a partir da retirada na secretaria.</p>
            </div>
        </div>

    </main>

    <footer>
        <p>Feito com ❤️ por Aura</p>
    </footer>
</body>
</html>

 <script>
    // localStorage.removeItem("books")
    // --- Variáveis Globais e Seletores de Elementos ---
    const loanModal = document.getElementById('loanModal');
    const closeButton = document.querySelector('.close-button');
    const confirmLoanBtn = document.getElementById('confirmLoanBtn');
    const modalBookTitle = document.getElementById('modalBookTitle');
    const studentNameInput = document.getElementById('studentName');
    const studentClassInput = document.getElementById('studentClass');
    const loanCodeDisplay = document.getElementById('loanCodeDisplay');
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const bookListContainer = document.getElementById('bookList');

    // VARIÁVEIS PARA FILTROS DE PESQUISA
    const searchInput = document.getElementById('searchInput');
    const filterButtons = document.querySelectorAll('.filter-buttons button');

    let currentBookId = null; // Usado para empréstimo
    let activeGenreFilter = 'all'; // 'all', 'available', 'Ficção', 'Fantasia', etc.

    // --- Funções de Gerenciamento de Dados (Livros) ---
    function loadBooks() {
        const books = JSON.parse(localStorage.getItem('books')) || [];
        return books;
    }

    function saveBooks(books) {
        localStorage.setItem('books', JSON.stringify(books));
    }
	
	function generateUniqueId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    // --- Funções de Gerenciamento de Dados (Empréstimos) ---
    function loadLoans() {
        const loans = JSON.parse(localStorage.getItem('loans')) || [];
        return loans;
    }

    function saveLoans(loans) {
        localStorage.setItem('loans', JSON.stringify(loans));
    }

    // --- Funções para Renderizar Livros na UI ---
    function renderBooks() {
        const books = loadBooks();
        bookListContainer.innerHTML = '';

        const filteredBooks = applyFilters(books);

        if (filteredBooks.length === 0) {
            bookListContainer.innerHTML = '<p style="text-align: center; margin-top: 50px;">Nenhum livro encontrado com os filtros selecionados.</p>';
        } else {
            filteredBooks.forEach(book => {
                const bookCard = `
                    <div class="book-card" data-book-id="${book.id}" data-book-title="${book.title}" data-book-author="${book.author}" data-book-genre="${book.genre}" data-book-status="${book.status}">
                        <img src="${book.cover || 'https://placehold.co/100x150?text=Sem+Foto'}" alt="Capa do Livro: ${book.title}" onerror="this.onerror=null;this.src='https://placehold.co/100x150?text=Sem+Foto';">
                        <h3>${book.title}</h3>
                        <p>Autor: ${book.author}</p>
                        <p class="book-status">${book.status === 'available' ? 'Disponível' : `Emprestado`}</p>
                        <button class="btn-emprestar" ${book.status !== 'available' ? 'disabled' : ''}>Emprestar</button>
                    </div>
                `;
                bookListContainer.insertAdjacentHTML('beforeend', bookCard);
            });
        }
        
        document.querySelectorAll('.btn-emprestar').forEach(button => {
            button.addEventListener('click', (event) => {
                const bookCard = event.target.closest('.book-card');
                const bookTitle = bookCard.querySelector('h3').textContent;
                const bookId = bookCard.dataset.bookId;
                openLoanModal(bookTitle, bookId);
            });
        });
    }

    // --- Função para Aplicar Filtros ---
    function applyFilters(books) {
        let filteredBooks = [...books];
        const searchTerm = searchInput.value.trim().toLowerCase();
        if (searchTerm) {
            filteredBooks = filteredBooks.filter(book =>
                book.title.toLowerCase().includes(searchTerm) ||
                book.author.toLowerCase().includes(searchTerm)
            );
        }

        if (activeGenreFilter === 'available') {
            filteredBooks = filteredBooks.filter(book => book.status === 'available');
        } else if (activeGenreFilter !== 'all') {
            filteredBooks = filteredBooks.filter(book => {
                if (Array.isArray(book.genre)) {
                    return book.genre.includes(activeGenreFilter);
                } else {
                    return book.genre === activeGenreFilter;
                }
            });
        }
        return filteredBooks;
    }

    // --- Funções para o Modal de Empréstimo ---
    function openLoanModal(bookTitle, bookId) {
        modalBookTitle.textContent = bookTitle;
        currentBookId = bookId;
        loanCodeDisplay.style.display = 'none';
        loanCodeDisplay.textContent = '';
        studentNameInput.value = '';
        studentClassInput.value = '';
        confirmLoanBtn.disabled = false;
        loanModal.classList.add('show');
    }

    function closeLoanModal() {
        loanModal.classList.remove('show');
    }

    // --- Event Listeners ---
    closeButton.addEventListener('click', closeLoanModal);
    window.addEventListener('click', (event) => {
        if (event.target === loanModal) {
            closeLoanModal();
        }
    });

    confirmLoanBtn.addEventListener('click', () => {
        const studentName = studentNameInput.value.trim();
        const studentClass = studentClassInput.value.trim();
        if (studentName === '' || studentClass === '') {
            alert('Por favor, preencha seu nome e turma para prosseguir.');
            return;
        }

        const loanCode = `ETEC-${Math.random().toString(36).substr(2, 6).toUpperCase()}`;
        const newLoan = {
            id: generateUniqueId(),
            bookId: currentBookId,
            studentName: studentName,
            studentClass: studentClass,
            loanCode: loanCode,
            loanDate: new Date().toISOString(),
            pickupDate: null,
            returnDate: null,
            status: 'pending'
        };

        const loans = loadLoans();
        loans.push(newLoan);
        saveLoans(loans);
		
		let books = loadBooks();
		books = books.map(book => {
			if(book.id === currentBookId) {
				return {...book, status: 'pending'}
			}
			return book;
		});
		saveBooks(books);

        loanCodeDisplay.innerHTML = `Seu código de retirada: <br><strong>${loanCode}</strong><br>Anote este código para apresentar na secretaria.`;
        loanCodeDisplay.style.display = 'block';
		confirmLoanBtn.disabled = true;

        renderBooks();
    });

    adminLoginBtn.addEventListener('click', () => {
        window.location.href = 'admin_login.html';
    });
	
	filterButtons.forEach(button => {
        button.addEventListener('click', () => {
            filterButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            activeGenreFilter = button.dataset.filter;
            renderBooks();
        });
    });

    searchInput.addEventListener('input', renderBooks);
	
	document.addEventListener('DOMContentLoaded', () => {
        if (!localStorage.getItem('books')) {
            const initialBooks = [
                {
                    id: 'book1',
                    title: 'O Pequeno Príncipe',
                    author: 'Antoine de Saint-Exupéry',
                    genre: ['Ficção'],
                    cover: 'https://editorapaulus.vtexassets.com/arquivos/ids/158669/o-pequeno-principe-capa-flexivel.png',
                    status: 'available',
                    returnDate: null
                },
                {
                    id: 'book2',
                    title: 'Dom Casmurro',
                    author: 'Machado de Assis',
                    genre: ['Ficção', 'Romance'],
                    cover: 'https://m.media-amazon.com/images/I/61Z2bMhGicL.jpg',
                    status: 'available',
                    returnDate: null
                },
                {
                    id: 'book3',
                    title: '1984',
                    author: 'George Orwell',
                    genre: ['Ficção', 'Ficção Científica'],
                    cover: 'https://m.media-amazon.com/images/I/819js3EQwbL.jpg',
                    status: 'available',
                    returnDate: null
                },
                {
                    id: 'book4',
                    title: 'Sapiens: Uma Breve História da Humanidade',
                    author: 'Yuval Noah Harari',
                    genre: ['História', 'Não Ficção'],
                    cover: 'https://m.media-amazon.com/images/I/81BTkpMrLYL.jpg',
                    status: 'available',
                    returnDate: null
                },
                {
                    id: 'book5',
                    title: 'O Hobbit',
                    author: 'J.R.R. Tolkien',
                    genre: ['Fantasia', 'Ficção'],
                    cover: 'https://m.media-amazon.com/images/I/91M9xPIf10L.jpg',
                    status: 'available',
                    returnDate: null
                },
                {
                    id: 'book6',
                    title: 'Frankenstein',
                    author: 'Mary Shelley',
                    genre: ['Ficção Científica', 'Ficção'],
                    cover: 'https://m.media-amazon.com/images/I/710p9SUfZtL._UF1000,1000_QL80_.jpg',
                    status: 'available',
                    returnDate: null
                }
            ];
            saveBooks(initialBooks);
        }
		
		const allButton = document.querySelector('.filter-buttons button[data-filter="all"]');
        if (allButton) {
            allButton.classList.add('active');
        }

        renderBooks();
    });
</script>
<script>
    (function(d){
      var s = d.createElement("script");
      s.setAttribute("data-account", "8b1e7e2d-7e7e-4b7e-8e7e-2d7e7e4b7e8e"); // ID de demonstração
      s.src="https://cdn.userway.org/widget.js";
      (d.body || d.head).appendChild(s);
    })(document)
    </script>
</body>
</html>